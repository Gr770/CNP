assign_caliph_laqab = {
    common_interaction = yes
    category = interaction_category_friendly
    popup_on_receive = no
    needs_recipient_to_open = yes
    ai_max_reply_days = 1

    desc = assign_caliph_laqab_desc

    is_shown = {
        scope:actor = {
            has_religion = religion:islam_religion
            this.faith.religious_head = this
        }
        scope:recipient = {
            has_religion = religion:islam_religion
            this.faith.religious_head = scope:actor
            has_culture_group = culture_group:arabic_group
            NOT = {
                has_character_flag = has_reg_laqab
                has_character_flag = has_regnal_laqab
                has_character_flag = has_caliph_laqab
            }
        }
    }
    is_valid = {
        scope:actor = {
            has_religion = religion:islam_religion
            this.faith.religious_head = this
            trigger_if = {
                limit = { is_ai = yes }
                opinion = {
                    target = scope:recipient
                    value >= 50
                }
            }
            trigger_else = {
                always = yes
            }
        }
        scope:recipient = {
            has_religion = religion:islam_religion
            this.faith.religious_head = scope:actor
            has_culture_group = culture_group:arabic_group
            NOT = {
                has_character_flag = has_reg_laqab
                has_character_flag = has_regnal_laqab
                has_character_flag = has_caliph_laqab
            }
        }
        }
    }
    auto_accept = yes
    send_option = {
        is_shown = {
            scope:actor = {
                has_religion = religion:islam_religion
                this.faith.religious_head = this
            }
            scope:recipient = {
                has_religion = religion:islam_religion
                this.faith.religious_head = scope:actor
                has_culture_group = culture_group:arabic_group
            }
        }
        is_valid = {
            scope:actor = {
                has_religion = religion:islam_religion
                this.faith.religious_head = this
                trigger_if = {
                    limit = { is_ai = yes }
                    opinion = {
                        target = scope:recipient
                        value >= 50
                    }
                }
                trigger_else = {
                    always = yes
                }
            }
            scope:recipient = {
                has_religion = religion:islam_religion
                this.faith.religious_head = scope:actor
                has_culture_group = culture_group:arabic_group
            }
        }
        current_description = assign_caliph_laqab_get_event_desc
        localization = assign_caliph_laqab_get_event
    }
    on_send = {
        if = {
            limit = { scope:actor = { is_ai = no } }
            scope:actor = {
                trigger_event = {
                    id = arabicnamepack.004
                    days = -1
                }
            }
        }
        else_if = {
            limit = { scope:recipient = { is_ai = no } }
            scope:recipient = {
                trigger_event = {
                    id = arabicnamepack.005
                    days = -1
                }
            }
        }
        else = {
            scope:recipient = {
                trigger_event = {
                    id = arabicnamepack.006
                    days = -1
                }
            }
        }
    }
    ai_targets = {
        ai_recipients = peer_vassals
        ai_recipients = sub_realm_characters
        ai_recipients = realm_characters
        ai_recipients = vassals
        ai_recipients = liege
        ai_recipients = war_allies
        ai_recipients = neighboring_rulers
        chance = .5
    }
    ai_frequency = 36
    ai_potential = {
        always = yes
    }
    ai_will_do = 100
}